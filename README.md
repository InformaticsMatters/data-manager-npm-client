# Client generator for the Squonk Data Manager API

[![npm version](https://badge.fury.io/js/%40squonk%2Fdata-manager-client.svg)](https://badge.fury.io/js/%40squonk%2Fdata-manager-client)

This repo is a NodeJS package that generates a typescript client from an open api specification.

- Consumes the Squonk Data Manager API
- Generated by [Orval](https://orval.dev)
- Typescript
- Calls made by Axios (this might change)
- Functions to call each API path
- React-Query hooks for use in React applications
- Built with [tsup](https://tsup.egoist.sh/)

## Build

Developed on `Node 16` and `npm 7`


1. Install dependencies with `npm i`
2. Copy a version of the data-manager-api open-api YAML file in to the repo root
3. Generate the client with `npm run build`
4. This can then be deployed with `npm publish`


## Commands

- `npm run orval` will generate the client with Orval
- `npm run build` will generate the client and then bundle it and create a version that can be deployed to npm
- `npm run watch` will watch for changes in the repo and rebundle when changes re detected. It does not regenerate the client automatically.

## Output

The contents published packages depend on the version of the `openapi.yaml` used to generate it. In general though, the package is organised as follows:

All types can be imported from the main entry point:
```ts
import type { Task, JobDetail, ... } from '@squonk/data-manager-client';
```

The custom instance (what is used to make all Axios calls) can also be imported from here:

```ts
import { customInstance } from '@squonk/data-manager-client';
```

Each `tag` from the `openapi.yaml` is used to create a sub-entry point. For example, the functions to make requests and the `react-query` hooks for a `dataset` tag can be imported as follows:

```ts
import { useGetDatasets, useCreateDataset, createDataset, ... } from '@squonk/data-manager-client/dataset';
```
